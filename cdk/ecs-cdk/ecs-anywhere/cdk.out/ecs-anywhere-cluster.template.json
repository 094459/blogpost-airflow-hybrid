{
  "Resources": {
    "hybridairflowrole531F1EDE": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "ssm.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/AmazonSSMManagedInstanceCore"
              ]
            ]
          },
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AmazonEC2ContainerServiceforEC2Role"
              ]
            ]
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ecs-anywhere-cluster/hybrid-airflow-role/Resource"
      }
    },
    "hybridairflowextcluster": {
      "Type": "AWS::ECS::Cluster",
      "Properties": {
        "ClusterName": "hybrid-airflow-extcluster"
      },
      "Metadata": {
        "aws:cdk:path": "ecs-anywhere-cluster/hybrid-airflow-extcluster"
      }
    },
    "hybridairflowexttask": {
      "Type": "AWS::ECS::TaskDefinition",
      "Properties": {
        "ContainerDefinitions": [
          {
            "Command": [
              "ricsue-airflow-hybrid",
              "period1/hq-data.csv",
              "select * from customers WHERE location = \"Spain\"",
              "rds-airflow-hybrid",
              "eu-west-2"
            ],
            "Cpu": 256,
            "Essential": true,
            "Image": {
              "Fn::Join": [
                "",
                [
                  "704533066374.dkr.ecr.eu-west-2.",
                  {
                    "Ref": "AWS::URLSuffix"
                  },
                  "/hybrid-airflow:airflw"
                ]
              ]
            },
            "LogConfiguration": {
              "LogDriver": "awslogs",
              "Options": {
                "awslogs-group": "/ecs/test-external",
                "awslogs-region": "eu-west-2",
                "awslogs-stream-prefix": "ecs"
              }
            },
            "Memory": 256,
            "Name": "elt-remote"
          }
        ],
        "Cpu": "1024",
        "Family": "apache-airflow",
        "Memory": "1024",
        "NetworkMode": "host",
        "RequiresCompatibilities": [
          "EXTERNAL"
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ecs-anywhere-cluster/hybrid-airflow-exttask"
      }
    },
    "CDKMetadata": {
      "Type": "AWS::CDK::Metadata",
      "Properties": {
        "Analytics": "v2:deflate64:H4sIAAAAAAAA/03LQQrCMBBA0bN0n04bi+hS7AEq8QQhjhhrM2UyQUrI3SW6cfX+5mvIeneAvjnZd2zdbe4cMUK+inWzGu/BYKTEDmtPSdYkaqQQhZOTonQ//L/V7O0C2dDru1SLQsdgcKXohXg724ilqMsmDwrdAEfYN8/ofcspiF8QzM8PecaV3JwAAAA="
      },
      "Metadata": {
        "aws:cdk:path": "ecs-anywhere-cluster/CDKMetadata/Default"
      }
    }
  },
  "Outputs": {
    "ECSAnyWhereIamRole": {
      "Description": "IAM Role created for ECSAnwhere",
      "Value": {
        "Ref": "hybridairflowrole531F1EDE"
      }
    },
    "ECSClusterName": {
      "Description": "Name of ECS Cluster created",
      "Value": "hybrid-airflow-extcluster"
    }
  }
}